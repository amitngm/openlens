# Health Check Flow
#
# Simple flow to verify basic connectivity and authentication.
# Use as a smoke test before running more complex flows.

name: health-check
description: "Basic health check for CMP connectivity and authentication"
version: "1.0.0"
author: "QA Agent Team"
tags:
  - smoke
  - health
  - quick

allowed_environments:
  - dev
  - staging
  - qa
  - production

required_variables:
  - testTenant

default_variables:
  testTenant: true

timeout_ms: 120000  # 2 minutes
capture_screenshots: true
capture_video: false
capture_har: false

steps:
  - name: "API Health Check"
    description: "Verify API is responding"
    type: api
    api:
      method: GET
      url: "${API_BASE_URL}/health"
      expected_status: 200
      timeout_ms: 10000
      assertions:
        - type: exists
          target: "$.status"
          message: "Health endpoint should return status"

  - name: "UI Accessibility Check"
    description: "Verify UI is accessible"
    type: ui
    ui:
      action: navigate
      url: "${UI_BASE_URL}"
      timeout_ms: 30000
      screenshot: true

  - name: "Login Check"
    description: "Verify login page loads"
    type: ui
    ui:
      action: wait_for_selector
      selector: "input[name='username'], input[type='email'], #username, .login-form"
      timeout_ms: 15000
      screenshot: true
