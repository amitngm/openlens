# Staging environment values
# Usage: helm install qa-pr-dashboard . -f values-staging.yaml

image:
  frontend:
    repository: amitngm/qa-pr-dashboard-frontend
    pullPolicy: IfNotPresent
    tag: "latest"  # Can use latest in staging
  api:
    repository: amitngm/qa-pr-dashboard-api
    pullPolicy: IfNotPresent
    tag: "latest"

replicaCount: 2

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80

resources:
  frontend:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  api:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-staging"
  hosts:
    - host: qa-pr-dashboard-staging.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: qa-pr-dashboard-staging-tls
      hosts:
        - qa-pr-dashboard-staging.example.com

env:
  api:
    NODE_ENV: staging
    MONGODB_URI: "mongodb://mongodb-service-staging:27017"
    DB_NAME: "qa_pr_dashboard_staging"

# MongoDB configuration (if deploying MongoDB)
mongodb:
  enabled: false
  serviceName: "mongodb-service-staging"
  port: 27017
  # MongoDB resource configuration
  resources:
    requests:
      cpu: 250m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 2Gi
  # Storage configuration
  storage:
    size: 50Gi
    storageClass: ""
    accessMode: ReadWriteOnce
  # Replica set configuration
  replicaCount: 1
  persistence:
    enabled: true
    size: 50Gi
    storageClass: ""
  frontend:
    NODE_ENV: production
    API_URL: "http://qa-pr-dashboard-api:8000/api"
    NEXT_PUBLIC_API_URL: "https://qa-pr-dashboard-staging.example.com/api"


